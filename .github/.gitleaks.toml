# Gitleaks configuration for go-bsv-middleware
# This file defines rules for secret scanning and allowlists for test/example credentials

title = "gitleaks config for go-bsv-middleware"

# Allowlist specific test/example credentials
[[rules]]
description = "Generic API Key"
id = "generic-api-key"
regex = '''(?i)(\bapi[_-]?key\b|\bsecret\b)'''
[[rules.allowlist]]
description = "Ignore test/example credentials with gitleaks:allow comment"
regexTarget = "line"
regex = '''gitleaks:allow'''

# Allowlist specific test credentials
[[rules.allowlist]]
description = "Test WIF credential (serverWIF) used in examples and fixtures"
regexTarget = "match"
regex = '''L1cReZseWmqcYra3vrqj9TPBGHhvDQFD2jYuu1RUj5rrfpVLiKHs'''

[[rules.allowlist]]
description = "Test private key hex (clientPrivHex/alicePrivKey) used in examples and regression tests"
regexTarget = "match"
regex = '''143ab18a84d3b25e1a13cefa90038411e5d2014590a2a4a57263d1593c8dee1c'''

[[rules.allowlist]]
description = "Historical test WIF credential - no longer in use but in git history"
regexTarget = "match"
regex = '''L268WKbTbLTrZL6aW5A5rzd4'''

[[rules.allowlist]]
description = "Historical test public key - no longer in use but in git history"
regexTarget = "match"
regex = '''0279be667ef9dcbbac55a062'''

# Allowlist paths for test fixtures and examples
[[rules.allowlist]]
description = "Ignore credentials in test fixtures, examples, and regression tests"
paths = [
    '''pkg/internal/testabilities/fixture/.*''',
    '''pkg/internal/regressiontests/.*''',
    '''examples/.*''',
]
